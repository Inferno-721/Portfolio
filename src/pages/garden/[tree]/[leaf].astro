---
import BaseLayout from "@/layouts/BaseLayout.astro";
import BackLink from "@/components/garden/BackLink.astro";
import LeafHeader from "@/components/garden/LeafHeader.astro";
import LeafContent from "@/components/garden/LeafContent.astro";
import { trees, metadata } from "@garden";

export function getStaticPaths() {
  return trees.flatMap((tree) =>
    tree.leaves.map((leaf) => ({
      params: { tree: tree.slug, leaf: leaf.slug },
      props: { tree, leaf },
    })),
  );
}

const { tree, leaf } = Astro.props;
---

<BaseLayout title={leaf.title} description={leaf.content.substring(0, 150)}>
  <div class="container mx-auto pt-24 pb-12 md:pt-32 xl:pt-24">
    <BackLink href={`/garden/${tree.slug}`} text={`Back to ${tree.name}`} />

    <article class="prose prose-lg max-w-none dark:prose-invert">
      <LeafHeader leaf={leaf} metadata={metadata} />
      <LeafContent content={leaf.content} references={leaf.references} />
    </article>
  </div>
</BaseLayout>
